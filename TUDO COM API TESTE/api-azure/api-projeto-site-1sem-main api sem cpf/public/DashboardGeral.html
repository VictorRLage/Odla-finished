<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard || ODLA</title>
    <link rel="icon" href="https://i.imgur.com/RYeRxVL.png">
    <link rel="stylesheet" href="TUDO.css">
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
    <script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>

</head>

<body class="corpoDG">
    <!-- Header -->
    <div class="header">

        <div class="container">

            <a href="index.html"><img src="https://i.imgur.com/d1sFhNj.png" class="logo_header"></a>

            <ul class="navbar">
                <li><a class="aH" href="index.html"> Início</a></li>
                <li><a class="aH" href="SobreNósV2.html"> Sobre Nós</a></li>
                <li><a class="aH" href="Servicos.html">Serviços</a></li>
                <li><a class="aH" href="contato.html">Contato</a></li>
                <li class="entrarheader"><img class="logo_entar" src="https://i.imgur.com/TRccn0N.png" align="center">
                    <a class="link_a" href="login.html"> Entrar</a>
                </li>
            </ul>

            <button class="btn_simulador" onclick="window.location.href='SimuladorODLA.HTML';">Simulador
                Financeiro</button>

        </div>
    </div>
    <!-- Fim do Header -->
    <!-- Banner -->
    <div class="bannerDG">
        <div class="esquerdaDG">
            <span class="TituloDG">Consumo mensal (Kw)</span>
            <div class="card1DG">
                <canvas id="conMenBar" style="width: 200px; height: 200px;"></canvas>
            </div>
            <span class="Titulo2DG">Consumo mensal por sensor (Kw)</span>
            <div class="card2DG">
                <canvas id="conMenLine" style="width: 100px; height: 38px;"></canvas>


            </div>
            <div class="deskDG">
                <h3>Alguma duvida?</h3>
                <button onclick="window.location.href='https://app.pipefy.com/public/form/2qbkkivf';">Entre em
                    contato com o nosso suporte!</button>
            </div>
        </div>


        <div class="direitaDG">
            <div class="btnDG">
                <button id="open" class="btn_uDG">Adicionar usuário</button>
            </div>
            <div onclick="window.location.href='DashboardSensor1.html'" class="card3DG">
                <canvas id="canvas_grafico" style="width: 450px; height: 200px;"></canvas>
            </div>


            <div onclick="window.location.href='DashboardSensor2.html'" class="card4DG">
                <canvas id="sensor2Line" style="width: 450px; height: 200px;"></canvas>
            </div>


            <div onclick="window.location.href='DashboardSensor3.html'" class="card5DG">
                <canvas id="sensor3Line" style="width: 450px; height: 200px;"></canvas>
                <!-- <button class="btn_addDS" onclick="addValor1()">Adicionar</button>   -->
            </div>


            <div onclick="window.location.href='DashboardSensor4.html'" class="card6DG">
                <canvas id="sensor4Line" style="width: 450px; height: 200px;"></canvas>
            </div>

            <div onclick="window.location.href='DashboardSensor5.html'" class="card7DG">
                <canvas class="sensor5LineDG" id="sensor5Line" style="width: 450px; height: 200px;"></canvas>
                <img class="manutencaoDG" src="https://i.imgur.com/frbLIG3.png">
            </div>

            <div onclick="window.location.href='DashboardSensor6.html'" class="card8DG">
                <canvas class="sensor6LineDG" id="sensor6Line" style="width: 450px; height: 200px;"></canvas>
                <img class="indisponivelDG" src="https://i.imgur.com/tk0UfYf.png">
            </div>

        </div>
    </div>
</body>
<!--Footer -->
<footer>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <div class="footer-content">
        <h1> <a class="a_contato" href="contato.html">CONTATE-NOS</a></h1>
        <span>
            Rua Haddock Lobo, 595 - Cerqueira César, São Paulo - SP, 01414-001 <br>
            Whatsapp:(11) 93238-5592 || Telefone:(11) 4782-2076 || Email:odlacontato@gmail.com
        </span>
        <ul class="sociais">
            <li><a class="a_f" href="https://www.facebook.com/Odla-Vertical-Farm-112135644819539/"><i
                        class="fa fa-facebook"></i></a></li>
            <li><a class="a_f" href="https://twitter.com/OdlaOficial"><i class="fa fa-twitter"></i></a></li>
            <li><a class="a_f" href="https://www.youtube.com/channel/UC2dvFbEdU46ZBE8hmi7pEAA"><i
                        class="fa fa-youtube"></i></a>
            </li>
            <li><a class="a_f" href="https://www.linkedin.com/in/odla-vertical-farm-5aa654239/"><i
                        class="fa fa-linkedin-square"></i></a></li>
        </ul>
    </div>

    <div class="modal-containerALERTAamarelo" id="modal_containerALERTAamarelo">
        <div class="modalALERTAamarelo">
            <h1 id="msgALERTAamarelo"></h1>
        </div>
    </div>
    <div class="footer-bottom">
        <p>Copyright &copy;2022 ODLA</p>
    </div>

</footer>
<!--Fim Footer -->
<!--Modal-->
<div class="modal-containerDG" id="modal_container">
    <div class="modalDG">
        <h1 id="titulo_M">Cadastre um usuário</h1>
        <div class="inputgodDG">
            <input type="email" name="email" class="input1DG" id="email_input" placeholder="Email"><br>
            <input type="password" name="" class="input2DG" id="senha_input" placeholder="Senha"> <br>
            <button class="entrarDG" onclick="cadastrarU()">Entrar</button>

        </div>
    </div>
    <button class="button1DG" id="close">X</button>
    <div class="div_erroDG" id="div_erro" style="display: none;"><span style=" margin-left: 100px" id="msg_erro"
            class="msg_erroDG"></span></div>
</div>
<!--Modal-->
<div class="modal-containerDG2" id="modal_container2">
    <div class="modalDG2">
        <h1 id="titulo_M2"></h1>
    </div>
</div>


</html>
<!-- Sensor 1 DINAMICO -->
<script>
    let idAquario = 1

    window.onload = obterDadosGrafico(1);


    function obterDadosGrafico(idAquario) {

        // if (proximaAtualizacao != undefined) {
        //     clearTimeout(proximaAtualizacao);
        // }

        fetch(`/medidas/ultimas/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    resposta.reverse();

                    plotarGrafico(resposta, idAquario);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGrafico(resposta, i) {
        console.log('iniciando plotagem do gráfico...');

        var dados = {
            labels: [],
            datasets: [
                {
                    borderSkipped: 'bottom',
                    yAxisID: 'y-umidade',
                    label: 'Prateleira 1',
                    borderColor: 'rgb(78 178 101)',
                    backgroundColor: 'rgb(78 178 101)',
                    borderWidth: '3',
                    pointRadius: '6',
                    tension: '0.2',
                    fill: false,
                    data: []
                },
                // {
                //     yAxisID: 'y-temperatura',
                //     label: 'Temperatura',
                //     borderColor: 'white',
                //     backgroundColor: 'white',
                //     fill: true,
                //     data: []
                // }
            ]
        };

        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            dados.labels.push(registro.momento);
            dados.datasets[0].data.push(registro.Lux);
            if (registro.Lux < 15000 || registro.Lux > 85000) {
                        msgALERTAamarelo.innerHTML = `SENSOR 1 EM ESTADO CRÍTICO`
                        modal_containerALERTAamarelo.classList.add('showALERTAvermelho');
                        modal_containerALERTAamarelo.addEventListener('click', () => {
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                     });
                        dados.datasets[0].backgroundColor = 'rgb(255, 0, 0)';
                        dados.datasets[0].borderColor = 'rgb(255, 0, 0)';
                    } else if (registro.Lux < 40000 || registro.Lux > 50000) {
                        dados.datasets[0].backgroundColor = 'rgb(255, 226, 41)';
                        dados.datasets[0].borderColor = 'rgb(255, 226, 41)';
                        msgALERTAamarelo.innerHTML = `SENSOR 1 EM ESTADO DE ALERTA`
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                        modal_containerALERTAamarelo.classList.add('showALERTAamarelo');
                        modal_containerALERTAamarelo.addEventListener('click', () => {
                        modal_containerALERTAamarelo.classList.remove('showALERTAamarelo');
                     });
                    } else if (registro.Lux > 40000 || registro.Lux < 50000) {
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                        modal_containerALERTAamarelo.classList.remove('showALERTAamarelo');
                        dados.datasets[0].backgroundColor = 'rgb(78 178 101)';
                        dados.datasets[0].borderColor = 'rgb(78 178 101)';
                    }
        }


        console.log(JSON.stringify(dados));

        var ctx = canvas_grafico.getContext('2d');
        window.grafico_linha = Chart.Line(ctx, {
            data: dados,
            options: {
                responsive: true,
                animation: { duration: 500 },
                hoverMode: 'index',
                stacked: false,
                title: {
                    display: false,
                    text: 'Dados capturados'
                },
                scales: {
                    yAxes: [{
                        type: 'linear',
                        display: true,
                        position: 'left',
                        id: 'y-temperatura',
                        ticks: {
                            beginAtZero: true,
                            max: 100000,
                            min: 0
                        }
                    }, {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        id: 'y-umidade',
                        ticks: {
                            beginAtZero: true,
                            max: 100000,
                            min: 0
                        },

                        gridLines: {
                            drawOnChartArea: false,
                        },
                    }],
                }
            }
        });
        setTimeout(() => atualizarGrafico(idAquario, dados), 2000);
    }
    function atualizarGrafico(idAquario, dados) {
        msgALERTAamarelo.innerHTML = ``
        const modal_containerALERTAamarelo = document.getElementById('modal_containerALERTAamarelo');

        fetch(`/medidas/tempo-real/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico: ${dados}`);

                    // tirando e colocando valores no gráfico
                    dados.labels.shift(); // apagar o primeiro
                    dados.labels.push(novoRegistro[0].momento); // incluir um novo momento
                    dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                    dados.datasets[0].data.push(novoRegistro[0].Lux); // incluir uma nova medida de umidade
                    if (novoRegistro[0].Lux < 15000 || novoRegistro[0].Lux > 85000) {
                        msgALERTAamarelo.innerHTML = `SENSOR 1 EM ESTADO CRÍTICO`
                        modal_containerALERTAamarelo.classList.add('showALERTAvermelho');
                        modal_containerALERTAamarelo.addEventListener('click', () => {
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                     });
                        dados.datasets[0].backgroundColor = 'rgb(255, 0, 0)';
                        dados.datasets[0].borderColor = 'rgb(255, 0, 0)';
                    } else if (novoRegistro[0].Lux < 40000 || novoRegistro[0].Lux > 50000) {
                        dados.datasets[0].backgroundColor = 'rgb(255, 226, 41)';
                        dados.datasets[0].borderColor = 'rgb(255, 226, 41)';
                        msgALERTAamarelo.innerHTML = `SENSOR 1 EM ESTADO DE ALERTA`
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                        modal_containerALERTAamarelo.classList.add('showALERTAamarelo');
                        modal_containerALERTAamarelo.addEventListener('click', () => {
                        modal_containerALERTAamarelo.classList.remove('showALERTAamarelo');
                     });
                    } else if (novoRegistro[0].Lux > 40000 || novoRegistro[0].Lux < 50000) {
                        modal_containerALERTAamarelo.classList.remove('showALERTAvermelho');
                        modal_containerALERTAamarelo.classList.remove('showALERTAamarelo');
                        dados.datasets[0].backgroundColor = 'rgb(78 178 101)';
                        dados.datasets[0].borderColor = 'rgb(78 178 101)';
                    }
                    window.grafico_linha.update();

                    proximaAtualizacao = setTimeout(() => atualizarGrafico(idAquario, dados), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                proximaAtualizacao = setTimeout(() => atualizarGrafico(idAquario, dados), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }
</script>
<!-- Sensor 3 Config 8-->
<script>
    const labels8 = [
        '00:00',
        '03:00',
        '06:00',
        '09:00',
        '12:00',
        '15:00',
        '18:00',
        '21:00',
    ];
    const data8 = {
        labels: labels8,
        datasets: [{
            label: 'Prateleira 3',
            data: [45989, 46949, 47349, 48389, 49362, 46789, 49097, 48946],
            fill: false,
            borderColor: 'rgb(78 178 101)',
            backgroundColor: 'rgb(78 178 101)',
            tension: 0.2,
            pointRadius: 7
        }]
    };
    const options8 = {
        scales: {
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-temperatura',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                }
            }, {
                type: 'linear',
                display: false,
                position: 'right',
                id: 'y-umidade',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                },

                gridLines: {
                    drawOnChartArea: false,
                },
            }],
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config8 = {
        type: 'line',
        data: data8,
        options: options8,
    };

    // function addValor1() {
    //     let value1 = Math.random();
    //     let value =  value1 * 100000;
    //     console.log(value1);

    //     sensor3Line.data.datasets[0].data.push(parseInt(value));
    //     sensor3Line.data.labels.push(parseInt(value));

    //     if (value < 15000 || value > 85000) {
    //         sensor3Line.data.datasets[0].backgroundColor = 'rgb(255, 0, 0)';
    //         sensor3Line.data.datasets[0].borderColor = 'rgb(255, 0, 0)';
    //     } else if (value < 30000 || value > 60000) {
    //         sensor3Line.data.datasets[0].backgroundColor = 'rgb(255, 226, 41)';
    //         sensor3Line.data.datasets[0].borderColor = 'rgb(255, 226, 41)';
    //     }else if (value > 40000 || value < 50000) {
    //         sensor3Line.data.datasets[0].backgroundColor = 'rgb(78 178 101)';
    //         sensor3Line.data.datasets[0].borderColor = 'rgb(78 178 101)';
    //     }

    //     sensor3Line.update();

    //     let value2 = Number(parseInt(value1 *100)) +40;

    //     sensor3Line.data.datasets[0].data.push(value2);
    //     sensor3Line.data.labels.push(value2);
    //     sensor3Line.update();

        

    // }
</script>
<!-- Sensor 2 Config 7 -->
<script>
    const labels7 = [
        '00:00',
        '03:00',
        '06:00',
        '09:00',
        '12:00',
        '15:00',
        '18:00',
        '21:00',
    ];
    const data7 = {
        labels: labels7,
        datasets: [{
            label: 'Prateleira 2',
            data: [40989, 49949, 40349, 43389, 45362, 46789, 49097, 41946],
            fill: false,
            borderColor: 'rgb(78 178 101)',
            backgroundColor: 'rgb(78 178 101)',
            tension: 0.2,
            pointRadius: 7
        }]
    };
    const options7 = {
        scales: {
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-temperatura',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                }
            }, {
                type: 'linear',
                display: false,
                position: 'right',
                id: 'y-umidade',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                },

                gridLines: {
                    drawOnChartArea: false,
                },
            }],
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config7 = {
        type: 'line',
        data: data7,
        options: options7,
    };
</script>
<!-- Sensor 4 Config 6 -->
<script>
    const labels6 = [
        '00:00',
        '03:00',
        '06:00',
        '09:00',
        '12:00',
        '15:00',
        '18:00',
        '21:00',
    ];
    const data6 = {
        labels: labels6,
        datasets: [{
            label: 'Prateleira 4',
            data: [46989, 45949, 48349, 47389, 49999, 47789, 48097, 49946],
            fill: false,
            borderColor: 'rgb(78 178 101)',
            backgroundColor: 'rgb(78 178 101)',
            tension: 0.2,
            pointRadius: 7
        }]
    };
    const options6 = {
        scales: {
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-temperatura',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                }
            }, {
                type: 'linear',
                display: false,
                position: 'right',
                id: 'y-umidade',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                },

                gridLines: {
                    drawOnChartArea: false,
                },
            }],
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config6 = {
        type: 'line',
        data: data6,
        options: options6,
    };
</script>
<!-- Sensor 6  Config 5 -->
<script>
    const labels5 = [
        '00:00',
        '03:00',
        '06:00',
        '09:00',
    ];
    const data5 = {
        labels: labels5,
        datasets: [{
            label: 'Prateleira 6',
            data: [],
            fill: false,
            borderColor: 'rgb(78 178 101)',
            backgroundColor: 'rgb(78 178 101)',
            tension: 0.2,
            pointRadius: 7
        }]
    };
    const options5 = {
        scales: {
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-temperatura',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                }
            }, {
                type: 'linear',
                display: false,
                position: 'right',
                id: 'y-umidade',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                },

                gridLines: {
                    drawOnChartArea: false,
                },
            }],
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config5 = {
        type: 'line',
        data: data5,
        options: options5,
    };
</script>
<!-- Sensor 5 Config 4 -->
<script>
    const labels4 = [
        '00:00',
        '03:00',
        '06:00',
        '09:00',
    ];
    const data4 = {
        labels: labels4,
        datasets: [{
            label: 'Prateleira 5',
            data: [],
            fill: false,
            borderColor: 'rgb(78 178 101)',
            backgroundColor: 'rgb(78 178 101)',
            tension: 0.2,
            pointRadius: 7
        }]
    };
    const options4 = {
        scales: {
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-temperatura',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                }
            }, {
                type: 'linear',
                display: false,
                position: 'right',
                id: 'y-umidade',
                ticks: {
                    beginAtZero: true,
                    max: 100000,
                    min: 0
                },

                gridLines: {
                    drawOnChartArea: false,
                },
            }],
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config4 = {
        type: 'line',
        data: data4,
        options: options4,
    };
</script>
<!-- conMenBar Config 2 & conMenLine Config 3-->
<script>
    const labels2 = [
        'Janeiro',
        'Fevereiro',
        'Março',
        'Abril',
    ];
    const data2 = {
        labels: labels2,
        datasets: [{
            label: 'Sensor 1',
            data: [65, 59, 60, 61],
            backgroundColor: 'red',
            borderColor: 'red',
        },
        {
            label: 'Sensor 2',
            data: [65, 58, 50, 45],
            backgroundColor: 'blue',
            borderColor: 'blue',
        },
        {
            label: 'Sensor 3',
            data: [40, 48, 56, 37],
            backgroundColor: 'rgb(78 178 101)',
            borderColor: 'rgb(78 178 101)',
        },
        {
            label: 'Sensor 4',
            data: [68, 69, 69, 66],
            backgroundColor: 'yellow',
            borderColor: 'yellow',
        },
        {
            label: 'Sensor 5',
            data: [54, 52, 59],
            backgroundColor: 'aqua',
            borderColor: 'aqua',
        },
        {
            label: 'Sensor 6',
            data: [64, 62],
            backgroundColor: 'orange',
            borderColor: 'orange',
        },
        ]
    };
    const options9 = {
        scales: {
            xAxes: [{
                stacked: true
            }],
            yAxes: [{
                stacked: true
            }]
        }
    };
    const config2 = {
        type: 'bar',
        data: data2,
        options: options9,
    };
    const labels3 = [
        'Janeiro',
        'Fevereiro',
        'Março',
        'Abril',
    ];
    const data3 = {
        labels: labels3,
        datasets: [
            {
                label: 'Sensor 1',
                data: [65, 59, 60, 61],
                fill: false,
                borderColor: 'red',
                tension: 0.1
            },
            {
                label: 'Sensor 2',
                data: [65, 58, 50, 45],
                fill: false,
                borderColor: 'blue',
                tension: 0.1
            },
            {
                label: 'Sensor 3',
                data: [40, 48, 56, 37],
                fill: false,
                borderColor: 'rgb(78 178 101)',
                tension: 0.1
            },
            {
                label: 'Sensor 4',
                data: [68, 69, 69, 66],
                fill: false,
                borderColor: 'yellow',
                tension: 0.1
            },
            {
                label: 'Sensor 5',
                data: [54, 52, 59],
                fill: false,
                borderColor: 'aqua',
                tension: 0.1
            },
            {
                label: 'Sensor 6',
                data: [64, 62],
                fill: false,
                borderColor: 'orange',
                tension: 0.5
            },
        ]
    };
    const options3 = {
        scales: {
            y: {
                min: 0,
                max: 100
            }
        },
        plugins: {
            legend: {
                display: true,
                labels: {
                    color: 'black'
                }
            }
        }
    };
    const config3 = {
        type: 'line',
        data: data3,
        options: options3,
    };
</script>
<!-- inserir graficos estaticos -->
<script>
    const sensor5Line = new Chart(
        document.getElementById('sensor5Line'),
        config4
    );
    const sensor6Line = new Chart(
        document.getElementById('sensor6Line'),
        config5
    );
    const sensor4Line = new Chart(
        document.getElementById('sensor4Line'),
        config6
    );
    const sensor2Line = new Chart(
        document.getElementById('sensor2Line'),
        config7
    );
    const sensor3Line = new Chart(
        document.getElementById('sensor3Line'),
        config8
    );
    const conMenBar = new Chart(
        document.getElementById('conMenBar'),
        config2
    );
    const conMenLine = new Chart(
        document.getElementById('conMenLine'),
        config3
    );
</script>
<!-- modal usuario -->
<script>

    const open = document.getElementById('open');
    const modal_container = document.getElementById('modal_container');
    const close = document.getElementById('close');

    open.addEventListener('click', () => {
        modal_container.classList.add('show');
    });

    close.addEventListener('click', () => {
        modal_container.classList.remove('show');
    });

</script>
<!-- Cadastrar Usuario -->
<script>
    function cadastrarU() {
        titulo_M2.innerHTML = ``
        const modal_container2 = document.getElementById('modal_container2');
        let emailVar = email_input.value;
        let senhaVar = senha_input.value;
        let fkFazendaVar = sessionStorage.FK_FAZENDA
        let perfilVar = 2



        if (emailVar.indexOf("@") == -1 || emailVar.indexOf(".com") == -1 || senhaVar == '') {
            titulo_M2.innerHTML = `Email ou senha invalidos`
            modal_container2.classList.add('show2');
            modal_container2.addEventListener('click', () => {
                modal_container2.classList.remove('show2');
            });

            return;
        }

        // Enviando o valor da nova input
        fetch("/usuarios/cadastrarU", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                emailServer: emailVar,
                senhaServer: senhaVar,
                perfilServer: perfilVar,
                fkFazendaServer: fkFazendaVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                titulo_M2.innerHTML = `Usuário cadastrado com sucesso`
                modal_container2.classList.add('show2');
                modal_container2.addEventListener('click', () => {
                    modal_container2.classList.remove('show2');
                });

            } else {
                titulo_M2.innerHTML = `Email ou senha invalidos`
                modal_container2.classList.add('show2');
                modal_container2.addEventListener('click', () => {
                    modal_container2.classList.remove('show2');
                });
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);

        });

        return false;
    }
</script>
<script>

</script>